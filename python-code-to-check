from datetime import datetime, timedelta

# Initialize the RDS client
rds_client = boto3.client('rds')

# Replace 'database-1' with your RDS cluster identifier
cluster_identifier = 'database-1'

# List the snapshots for the specified RDS cluster
response = rds_client.describe_db_cluster_snapshots(DBClusterIdentifier=cluster_identifier)

# Get the current date and calculate the date one day ago
current_date = datetime.now()
one_day_ago = current_date - timedelta(days=1)

# Extract and print the snapshot names created yesterday
snapshot_names = []

for snapshot in response['DBClusterSnapshots']:
    snapshot_creation_date = snapshot['SnapshotCreateTime'].replace(tzinfo=None)
    if snapshot_creation_date >= one_day_ago and snapshot_creation_date < current_date and snapshot['SnapshotType'] =='automated':
        snapshot_names.append(snapshot['DBClusterSnapshotIdentifier'])
        print(snapshot_names)
        print(f"Snapshots created yesterday for cluster {cluster_identifier}:")
for name in snapshot_names:
    print(name)
